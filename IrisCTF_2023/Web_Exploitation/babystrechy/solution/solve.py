import subprocess

from pwn import *

context.log_level = 'DEBUG'

p = remote('stretchy.chal.irisc.tf', '10704')

p.recvuntil(b'pow) ')
args = ['python3', 'kctf-pow.py'] + p.recvuntil(b'\n', drop=True).decode().split()
r = subprocess.run(args, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
p.sendline(r.stdout)

p.recvuntil(b'> ')

candidates = '0123456789abcdef'
for i in candidates:
	for j in candidates:
		password = i * 64 + j * 8
		p.sendline(password.encode())
		if p.recv(2) != b'> ':
			p.interactive()